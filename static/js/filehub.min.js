/* filehub
 * Copyright (c) 2016 RaphaÃ«l Bois Rousseau
 * MIT Licensed
 */
var PROD=!0;!function(a,b,c){"use strict";function d(a,b,c,d,e){e||(e=a);var f=b[a];"function"==typeof f&&"function"!==d&&(f=f.call(b,a,c)),null==f||d&&typeof f!==d||c[e](f)}var e=(b.FILEHUB_BASEURL||"",b.filehub=function(){var a=b.FILEHUB_CTX;e.setup(),a&&"function"==typeof e["ctx:"+a]&&(b.FILEHUB_OBJ=e["ctx:"+a](),b.FILEHUB_OBJ.context=a)});"undefined"!=typeof console&&console.log&&b.FILEHUB_DEBUG?e.debug=console.log.bind(console):e.debug=function(){};var f=e.debug;e.register=function(a,b,c){if("string"!=typeof a)throw Error("register(): first argument must be a string");if(b&&"function"!=typeof b)throw Error("register(): second argument must be a function or null");return b&&(e["ctx:"+a]=b),"function"==typeof c&&(e.setup._load[a]=c),b};var g;e.setup=function(){function a(a,b,c){b.call(e)===!1?c.push({ctx:a,fn:b}):f("  '%s' loaded",a)}if(!g){g=!0;var b=[];f("Running setup functions...");for(var c in e.setup._load)a(c,e,b);for(var d,h=b.length,i=[];h;){if(!b.length){if(!i.length)break;if(i.length===h)throw Error("setup(): Some setup functions requirements couldn't be satisfied.");b=i,i=[],h=b.length}d=b.pop(),a(d.ctx,d.fn,i)}f("done.")}},e.support={pointerEvents:function(){var a,c=document.createElement("x"),d=document.documentElement,e=b.getComputedStyle;return"pointerEvents"in c.style?(c.style.pointerEvents="auto",c.style.pointerEvents="x",d.appendChild(c),a=e&&"auto"===e(c,"").pointerEvents,d.removeChild(c),!!a):!1}(),pushState:function(){return b.history&&"function"==typeof b.history.pushState}()},e.ease={inOutQuad:function(a,b,c,d){return d>0?(a/=d/2,1>a?b+a*a*c/2:(a--,b-(a*(a-2)-1)*c/2)):b+c}},e.build=function(b){var c,f,g=[];a.isArray(b)||(b=[b]);for(var h=0;h<b.length;h++)c=b[h],c&&("function"!=typeof c.cond||c.cond.call(c))&&(f=a("<"+(c.tag||"div")+"/>"),d("addClass",c,f,"string"),d("text",c,f,"string"),d("html",c,f,"string"),d("attr",c,f,"object"),d("prop",c,f,"object"),d("css",c,f,"object"),a.isArray(c.append)&&f.append(e.build(c.append)),a.isArray(c.prepend)&&f.prepend(e.build(c.prepend)),g=g.push(f.get(0)));return a(g)},e.modMask=function(a){return(a.ctrlKey?1:0)+(a.altKey?2:0)+(a.shiftKey?4:0)},e.messageBox=function(a,b,c){return c=c||"message",a.addClass(c+"-box"),a.children().length||a.append(e.build([{addClass:c+"-wrap",append:[{addClass:"padding-box1"},{addClass:"fixed-box",append:[{tag:"h1",text:"string"==typeof b?b:b.title||"-"},{tag:"p",addClass:"note",cond:function(){return!!b.message},text:b.message}]},{addClass:"padding-box2"}]}])),a},e.errorBox=function(a,b){return e.messageBox(a,{title:b&&b.title||"Unexpected error",message:b&&b.message||"An unexpected error occured."},"error")},e.createClass=function(b,c){if(!b)throw Error("class name required");c=c||{};var d=function(b){this.options=a.extend(!0,{},this.options||{},b||{}),this._actions={},"function"==typeof this._init&&this._init()},f=d.prototype;return e[b]=d,f._getAction=function(b){return this._actions[b]||(this._actions[b]=a.Callbacks()),this._actions[b]},f.on=function(b){var c=this;if("string"==typeof b){if(1===arguments.length)return;var d=c._getAction(b);d.add.apply(d,Array.prototype.slice.call(arguments,1))}else"object"==typeof b&&a.each(b,function(a,b){c._getAction(a).add(b)});return c},f.off=function(b){var c,d=this;if("string"==typeof b){if(c=d._actions[b],!c)return;if(arguments.length>1&&(c.remove.apply(c,Array.prototype.slice.call(arguments,1)),c.has()))return;delete d._actions[b]}else"object"==typeof b&&a.each(b,function(b,c){a.isArray(c)?(c=c.slice(0),c.shift(b),d.off.apply(d,c)):c?d.off(b,c):d.off(b)});return d},f.trigger=function(a,b){var c=this._actions[a];if(c)return c.fireWith(this,b||[]),this},a.extend(f,c),d},a(e)}(jQuery,window),function(a,b,c){"use strict";var d=b.filehub;Array.prototype.join,Array.prototype.slice,d.createClass("Api",{options:{apiUrl:(b.FILEHUB_BASEURL||"")+"/api"},_init:function(){this.FILE_RE=new RegExp("^/[^/]+/.*[^/]$")},get:function(b,c){return a.ajax(this.options.apiUrl+(b||""),{method:"GET",accepts:{json:"application/json"},cache:!1,data:c,dataType:"json"})},head:function(b,c){return a.ajax(this.options.apiUrl+(b||""),{method:"HEAD",cache:!1,data:c})},post:function(b,c){return null!=c&&"string"!=typeof c&&(c=JSON.stringify(c)),a.ajax(this.options.apiUrl+(b||""),{method:"POST",accepts:{json:"application/json"},contentType:"application/json",cache:!1,data:c||"{}",dataType:"json"})},put:function(b,c){return null!=c&&"string"!=typeof c&&(c=JSON.stringify(c)),a.ajax(this.options.apiUrl+(b||""),{method:"PUT",accepts:{json:"application/json"},contentType:"application/json",cache:!1,data:c||"{}",dataType:"json"})},del:function(b){return a.ajax(this.options.apiUrl+(b||""),{method:"DELETE",accepts:{json:"application/json"},cache:!1,dataType:"json"})},stat:function(a){return this.get("/repo/stat",{path:a})},sendFileUrl:function(a,b,c){var d=a.replace(/\/+$/,"")+"/"+b.name;return this.options.apiUrl+"/repo"+d+(c?"?replace=1":"")},getFile:function(a){return"/"!=a[0]&&(a="/"+a),this.FILE_RE.test(a)?(b.location.assign(this.options.apiUrl+"/repo"+a+"?attachment=1"),!0):!1},list:function(a,b){return this.get("/repo"+(a||"/"),{tree:b?1:0})},exists:function(a){return this.head("/repo"+(a||"/"))},trash:function(a){return this.del("/repo"+a)},createFolder:function(a,b){return b=b||{},b.name=a,this.post("/repo/",b)},updateFolder:function(a,b){return this.put("/repo/"+a+"/",b||{})},createDir:function(a,b){return this.put("/repo"+a+(b?"?parents=1":""))},trashList:function(){return this.get("/trash")},trashEmpty:function(){return this.del("/trash")},trashGet:function(a){return this.get("/trash/"+a)},trashDel:function(a){return this.del("/trash/"+a)},account:function(a){return this.get("/account/"+a)},accountExists:function(a){return this.head("/account/"+a)},accountUpdate:function(a,b){return this.put("/account/"+a,b||{})},accountDelete:function(a){return this.del("/account/"+a)},accountsList:function(a){var b=[];return a.accessLevel&&b.push("accessLevel="+a.accessLevel),a.email&&b.push("email="+a.email),this.get("/accounts"+(b.length?"?"+b.join("&"):""))},accountCreate:function(a,b,c,d){var e={username:a,password:b};return c&&(e.email=c),d&&(e.accessLevel=d),this.post("/accounts",e)}})}(jQuery,window),function(a,b,c){"use strict";var d=b.filehub;d.createClass("Aside",{options:{idPrefix:"t-",aside:"#view-aside",expandSelector:".fa",expandClasses:"fa-caret-right fa-caret-down"},_init:function(){var b=this,c=b.options;b.aside=a(c.aside),b.buttonBox=b.aside.children(".button-box"),b.treeBox=b.aside.children(".tree-box"),b.treeIdPrefix=b.treeBox.data("id-prefix")||"t-",b.buttonBox.on("click","button",function(c){var d=a(this);d.prop("disabled")||b.trigger("button",[d])}),b.treeBox.on("click",".tree-item-subtree > .tree-expand",function(b){var d=a(this).children(c.expandSelector);d.toggleClass(c.expandClasses),a(this).closest(".tree-item").next(".tree").slideToggle(300)}).on("click",".tree-item",function(c){var d=a(this);a(c.target).closest(".tree-expand").length||d.hasClass("active")||b.select(null,d)})},enable:function(a){var b=this.buttonBox.find("button");0===arguments.length&&(a=!0),b.prop("disabled",!a)},resize:function(a){this.aside.width(a)},width:function(){return this.aside.width()},select:function(b,c){var d=this,e=d.options;if(b||c?b?c||(c=a("#"+e.idPrefix+b)):b=c.data("uid"):c=d.treeBox.find(".tree-item:eq(0)"),!c.hasClass("active")){if(d.treeBox.find(".active").treeItemActive(!1),c.hasClass("tree-item")){c.treeItemActive(!0);for(var f=c.closest(".tree");f.length&&!f.is(":visible");)f=f.prev(".tree-item"),f.children(".tree-expand").click(),f=f.parent(".tree")}d.trigger("select",[b,c])}},update:function(b,c){var d,e,f=this,g=f.options,h=a("#"+g.idPrefix+b),j=h.next(".tree"),k=g.expandClasses.split(/ +/),l=[];if(!h.length||!c||!c.length)return void j.remove();for(j.empty(),d=h.children(".tree-pad").length,l.push({items:c,i:0,tree:j});l.length;)for(e=l.pop();e.i<e.items.length;e.i++){var m=e.items[i];a("div").treeItem({label:m.label,icon:m.icon,subtree:m.subtree&&m.subtree.length>0,expand:m.subtree?{off:k[0],on:k[1]}:!1,depth:d+l.length,idPrefix:g.idPrefix,uid:m.uid,active:m.active,"class":m["class"],data:m.data}).appendTo(e.tree);m.subtree&&m.subtree.length&&(l.push(e),e={items:m.subtree,i:0,tree:a('<div class="tree"/>').hide().appendTo(e.tree)})}}});a.fn.treeItem=function(a){var b=a.icon;if(this.empty().addClass("tree-item").toggleClass("tree-item-subtree",a.subtree).addClass(a["class"]||""),"string"==typeof b&&(b={off:b,on:b}),this.append(d.build([{addClass:"tree-expand",append:[{tag:"span",addClass:a.subtree&&a.expand?a.expand.off:""}]},{addClass:"tree-icon",append:[{tag:"span",addClass:b?b.off:""}]},{addClass:"tree-label",text:a.label||""}])),a.depth>0)for(var c=0;c<a.depth;c++)this.prepend('<div class="tree-pad"/>');a.uid&&(this.attr("id",a.idPrefix+a.uid),this.data("uid",a.uid)),"object"==typeof a.icon&&this.data({"ico-on":a.icon.on,"ico-off":a.icon.off}),this.data(a.data||{}),a.active&&this.treeItemActive()},a.fn.treeItemActive=function(a){a=0===arguments?!0:!!a,this.toggleClass("active",a);var b=this.data("ico-on"),c=this.data("ico-off");return b&&c&&this.find(".tree-icon > span").removeClass(c+" "+b).addClass(a?b:c),this}}(jQuery,window),function(a,b,c,d){"use strict";function e(b,c){c.sort(function(a,b){var c=a.data("key"),d=b.data("key");return d>c?-1:c>d?1:0}),a.fn.prepend.apply(b,c)}var f=b.filehub;f.createClass("AccessList",{options:{api:null,dialog:"#acl_dialog"},_init:function(){var b,c,d,e,g=this,h=g.options;g.api=h.api||new f.Api,g.dialog=b=a(h.dialog),g.title=b.find(".modal-title"),b.modal({show:!1}),c=g.aclLoading={body:b.find(".acl-loading"),btn:b.find(".acl-btnLoading")},c.all=a([c.body.get(0),c.btn.get(0)]),d=g.aclList={body:b.find(".acl-list"),ul:b.find(".acl-list > ul"),btn:b.find(".acl-btnList")},d.all=a([d.body.get(0),d.btn.get(0)]),d.user=d.ul.children("li.user").eq(0).detach(),d.add=d.ul.children("li.add").children("button"),d.add.on("click",function(c){c.preventDefault(),g.aclAll.hide(),e.all.show(),b.modal("handleUpdate"),e.div.find("input").each(function(){var b=a(this);b.prop("checkbox",!!b.attr("checkbox"))})}),e=g.aclSelect={body:b.find(".acl-select"),div:b.find(".acl-select > div"),btn:b.find(".acl-btnSelect")},e.all=a([e.body.get(0),e.btn.get(0)]),g.aclAll=a([c.body.get(0),c.btn.get(0),d.body.get(0),d.btn.get(0),e.body.get(0),e.btn.get(0)]),b.on("show.bs.modal",function(a){g.aclAll.hide(),c.all.show()}),b.find(".modal-footer").on("click","button",function(){var c=a(this).data("action");switch(c){case"cancel":b.trigger("abort.fh");break;case"cancel-select":g.aclAll.hide(),d.all.show(),b.modal("handleUpdate");break;case"select":b.trigger("select.fh");break;case"update":b.trigger("update.fh")}}),g.counter=0},edit:function(a,b,c){var d=this,e=++d.counter,f=d.dialog;d.title.text(d.title.data("text").replace("{folder}",a)),d.pendingAjax&&(d.pendingAjax.abort(),delete d.pendingAjax),f.modal("show"),f.one("abort.fh.fh"+e,function(a,b,d){f.off(".fh"+e),f.modal("hide"),b&&c(b,d)}).on("select.fh.fh"+e,function(a){d._select()}).one("update.fh.fh"+e,function(g){f.off(".fh"+e),f.modal("hide"),d._update(a,b,c)}),d.pendingAjax=d.api.stat(a).done(function(a,b,c){d.pendingAjax=d.api.accountsList({accessLevel:"user"}).done(function(b,c,e){var f=a&&a.accessList||{},g=b&&b.user||{};delete d.pendingAjax,d.populate(f,g)}).fail(function(a,b,c){delete d.pendingAjax,f.trigger("abort.fh","abort"!==c?[JSON.parse(c),a]:[])})}).fail(function(a,b,c){delete d.pendingAjax,f.trigger("abort.fh","abort"!==c?[JSON.parse(c),a]:[])})},populate:function(b,c){var d,f,g,h,i,j,k=this,l=k.aclList,m=k.aclSelect,n=0,o={};for(l.ul.children(".user").remove(),g=[],d=0;d<c.length;d++)f=c[d].username,o[f]=c[d],h="acl_u"+ ++n,i=a('<input id="'+h+'" type="checkbox"/>').val(f),o[f].ckb=i,j=a('<label for="'+h+'"/>').text(f),null!=b[f]&&i.prop("defaultChecked",!0),g.push(a("<div/>").attr("data-key",f).data("key",f).append(i,"&nbsp;",j));g.length&&m.div.empty().append.apply(m.div,g),k._addUser=function(b,c){var d=l.user.clone();return d.data("key",b),d.children("button").on("click",function(c){var d=a(this);c.preventDefault(),c.stopPropagation(),d.parent().remove(),o[b].ckb.prop("defaultChecked",!1)}),d.children("span.username").text(b),d.children("select").val("rw"===c?"rw":"ro"),d},g=[];for(f in b)o[f]&&g.push(k._addUser(f,b[f]));g.length&&e(l.ul,g),k.aclAll.hide(),l.all.show(),k.dialog.modal("handleUpdate")},_update:function(b,c,d){var e=this,f={};e.aclList.ul.children(".user").each(function(){var b=a(this),c=b.data("key");f[c]=b.children("select").val()||"ro"}),e.pendingAjax=e.api.updateFolder(b,{accessList:f}).done(function(){delete e.pendingAjax,c(f)}).fail(function(a,b,c){delete e.pendingAjax,c&&c!==abort&&d(JSON.parse(c),a)})},_select:function(){var b=this,c=[],d=b.aclList.ul.children(".user").detach().toArray(),e=d.length?a(d[0]):a(),f=e.data("key");b.aclSelect.div.children().each(function(){var g=a(this),h=g.data("key");if(g.children("input").prop("checked")){for(;d.length&&h>f;)d.shift(),e=d.length?a(d[0]):a(),f=e.data("key");h===f?c.push(e):c.push(b._addUser(h)),g.children("input").prop("defaultChecked",!0)}}),a.fn.prepend.apply(b.aclList.ul,c),b.aclAll.hide(),b.aclList.all.show(),b.dialog.modal("handleUpdate")}})}(jQuery,window,document),function(a,b,c){"use strict";function d(a,c){e.support.pushState?b.history.pushState(c,"",a):location.assign(a)}var e=b.filehub,f={folderAccessList:function(a){var b=this;1!==a.length||a.data("flags").indexOf("f")<0||(b.accessListDialog||(b.accessListDialog=new e.AccessList({api:b.api}),b.accessListDialog.dialog.on("show.bs.modal",function(a){b._scDisabled=!0}).on("hide.bs.modal",function(a){delete b._scDisabled})),b.accessListDialog.edit(a.data("path"),function(c){b.trigger("accessListUpdated",[a,c])},function(a,c){b.trigger("error",[a,c&&c.statusCode()])}))},itemDelete:function(a){},trashRestore:function(a){},trashRemove:function(a){}};e.register("browse",function(){var c,g=e.View,h=new e.Api,i=new g({});return i.on("refresh",function(a,b){c||d(b.data("url"),{ctx:this.context,url:b.data("url"),uid:a});var e,f=[],g=!0;do f.unshift({label:b.children(".tree-label").text(),cls:"subdir"+(g?"":" act"),data:{uid:b.data("uid")}}),g=!1,e=b.closest(".tree"),b=e.prev(".tree-item");while(b.length);this.nav.update(f)}).on("load",function(b,c,d){var e=this;e.sidePanel.enable(!1),a.get(c.data("url")+"?list-only=1",function(b){var c=a("<div/>").html(b).children(".list-box");c.length?d(null,c):d({statusCode:404,textStatus:"error",error:"Not Found"})}).fail(function(a,b,c){d({statusCode:a.statusCode(),textStatus:b,error:c})})}).on("activate",function(a){switch(a.data("type")){case"folder":this.sidePanel.select(a.data("uid"));break;default:h.getFile(a.data("path"))}}).on("view",function(a){this.sidePanel.enable((a.data("flags")||"").indexOf("w")>=0)}).on("select",function(b){var c=this.viewActive,d={},e=0;b.each(function(){var b=a(this),c=b.data("type");d[c]||(e++,d[c]=!0)}),this.nav.actions().each(function(){var f=a(this),g=f.data("select")||"single",h=(f.data("target")||"*").split("|"),i=h[1],j=h[2],k=!1;h=h[0];do{if(!b||!b.length)break;if(b.length>1&&"single"===g)break;if(j&&!c.is(j))break;if(i&&c.data("flags").indexOf(i)<0)break;if("*"!==h&&(1!==e||!d[h]))break;k=!0}while(0);f.toggle(k)})}).on("action",function(a,b){var c=this.getSelected(),d=f[a];d&&"function"==typeof d&&d.call(this,c,b)}),a(b).on("popstate",function(a){var b=a.originalEvent.state;b&&b.ctx===i.context&&(c=!0,i.sidePanel.select(b.uid),c=!1)}),i})}(jQuery,window),function(a,b,c){"use strict";var d=b.filehub;d.createClass("ListLoader",{options:{container:null},_init:function(){var b=this,c=b.options;b.container=a(c.container||[]),b.loader=b.container.children(".list-loader"),b.hide()},show:function(){this.loader.fadeIn("fast")},hide:function(){this.loader.fadeOut("fast")}})}(jQuery,window),function(a,b,c){"use strict";var d=b.filehub;d.createClass("Nav",{options:{nav:"#nav",navPadding:"#nav-padding",navPath:"#nav-path",navTools:"#nav-tools",pathSeparator:'<span class="fa fa-chevron-right"/>'},_init:function(){var b=this,c=b.options;a.each(["nav","navPadding","navPath","navTools"],function(d,e){b[e]=a(c[e])}),b.navPath.on("click",".navitem",function(c){var d=a(this);c.preventDefault(),c.stopPropagation();var e=d.data("uid");null!=e&&b.trigger("activate",[""+e,d])}),b.navTools.on("click",".view-action",function(c){var d=a(this);b.trigger("action",[d.data("action"),d])})},actions:function(){return this.navTools.children(".view-action")},padding:function(a){this.navPadding.width(a)},update:function(b){var c=this,d=c.navPath.children().detach(),e=a(c.options.pathSeparator||"<span/>");b?a.isArray(b)||(b=[b]):b=[];for(var f=0;f<b.length;f++){var g=b[f];if(f<d.length){if(null==g){c.navPath.append(d.get(f));continue}d=a()}null==g?g={}:"string"==typeof g&&(g={label:g}),a("<li/>").navItem(0==f,g.label||"-",g.cls||"",g.data||{},e).appendTo(c.navPath)}}});a.fn.navItem=function(b,c,d,e,f){return"boolean"!=typeof b&&(e=d,d=c,c=b,b=!1),this.empty(),!b&&f&&f.clone().appendTo(this),a('<span class="navitem"/>').addClass(d||"").data(e||{}).text(c||"").appendTo(this),this}}(jQuery,window),function(a,b,c){"use strict";var d=b.filehub,e=Math.abs,f=Math.max,g=Math.min,h=a(b),i=a(b.document),j="list-row",k=j+"-selected",l=j+"-prev",m=j+"-orig",n=j+"-dragged",o="on-drag",p=o+"-copy",q="view-droppable-hover";d.createClass("View",{options:{listIdPrefix:"l-",listExpire:300,viewResize:"#view-resize",viewContents:"#view-contents",shortcuts:{65:{1:"selectall"},46:{0:{eventname:"delete",rows:"."+k}},13:{0:{eventname:"activate",rows:"."+l}},32:{1:"cursortoggle"},38:{"*":{eventname:"cursorprevious",mods:!0}},40:{"*":{eventname:"cursornext",mods:!0}}}},_init:function(){var c=this;c._body=a(b.document.body),c.sidePanel=new d.Aside(c.options.aside),c.sidePanel.on("select",function(){c.trigger("refresh",arguments),c.loadTarget.apply(c,arguments)}).on("button",function(){c.trigger("button",arguments)}),c.nav=new d.Nav(c.options.nav),c.nav.on("activate",function(a){c.sidePanel.select(a)}).on("action",function(){c.trigger("action",arguments)}),c.viewResize=a("#view-resize"),c.viewContents=a("#view-contents"),c.viewActive=c.viewContents.children(".list-box:visible"),c.loader=new d.ListLoader({container:c.viewContents}),c._initResize(),c._initShortcuts(),c._initLists()},_initResize:function(){var a,b,c=this,d=c.sidePanel,e=c.viewResize.children(".view-handle");e.on("mousedown",function(e){1===e.which&&(a=d.width(),b=e.pageX,h.on("mousemove.resize",function(e){var g=e.pageX-b,h=f(0,a+g);d.resize(h),c.nav.padding(h)}).on("mouseup.resize",function(a){1===a.which&&h.off(".resize")}))})},getRows:function(a){var b=this.viewActive.children(".list").children(".list-group").children("."+j);return a?b.filter(a):b},getSelected:function(){return this.getRows("."+k)},_selectFromOrigin:function(b,c){var d,e,h,i,j,n,o,p,q=this,c=c||q.getRows();return c.each(function(c){var f=a(this);return this===b.get(0)&&(d=c),f.hasClass(l)&&(e=c),f.hasClass(m)&&(h=c),!(e>=0&&h>=0&&d>=0)}),0>d?void 0:(h=0>h?0:h,e=0>e?h:e,i=g(h,e),j=f(h,e),n=g(d,h),o=f(d,h),c.each(function(b){var c;b>=i&&j>=b&&(c=!1),b>=n&&o>=b&&(c=!0),"boolean"==typeof c&&a(this).toggleClass(k,c)}),c.removeClass(l),b.addClass(l),p=c.filter("."+k),q.trigger("select",[p]),p)},_updateCursor:function(a,b){var c,d,e=this,f=e.getRows("."+l);if(!f.length){if(d=f=e.getRows(":first"),!f.length)return;c=!0}return a?(c||(d=f[c||0>a?"prev":"next"](),d.length||(d=f)),void(b?1===b?(f.removeClass(l),d.addClass(l)):4===b&&e._selectFromOrigin(d):(e.getRows().removeClass(k+" "+m+" "+l),d.addClass(k+" "+m+" "+l),e.trigger("select",[d])))):void(1===b&&(e.getRows().removeClass(m+" "+l),f.toggleClass(k+" "+m+" "+l),e.trigger("select",[e.getSelected()])))},_initShortcuts:function(){var b=this;i.on("keydown.list-shortcuts",function(c){if(!b._body.hasClass(o)&&!a(c.target).closest("a,button,input,textarea,.dialog").length&&!b._scDisabled){var e,f,g=b.options.shortcuts,h=d.modMask(c),i=c.keyCode||c.which,j=[];f=g[i],f&&(e=h in f?f[h]:f["*"],"string"==typeof e&&(e={eventname:e}),e&&e.eventname&&(e.mods&&j.push(h),null!=e.rows&&j.push(b.getRows(e.rows)),c.preventDefault(),b.trigger(e.eventname,j)))}})},_initLists:function(){var b=this;b.on("selectall",function(){var a=b.getRows();a.removeClass(m).addClass(k),b.trigger("select",[a])}).on("unselectall",function(){b.getRows().removeClass(k+" "+m),b.trigger("select",[a()])}).on("cursorprevious",function(a){b._updateCursor(-1,a)}).on("cursornext",function(a){b._updateCursor(1,a)}).on("cursortoggle",function(){b._updateCursor(0,1)}),b.viewContents.on("mousedown","."+j,function(f){function g(a){a=a||0,x.removeClass(l),y.removeClass(m),x=y=s.addClass(l+" "+m),1&a||z.removeClass(k),s.toggleClass(k,1&a?c:!0),z=w.filter("."+k),b.trigger("select",[z])}function r(){var c,d,j=null,l=f.pageX,m=f.pageY;i.on("keydown.viewdrag keyup.viewdrag",function(a){b._body.toggleClass(p,a.ctrlKey)}),h.on("mousemove.viewdrag",function(f){var g;if(!c){if(c=e(l-f.pageX)+e(m-f.pageY)>2,!c)return;b._body.addClass(o).toggleClass(p,f.ctrlKey),z.addClass(n),d=b._dragInit(s,z,f.pageX,f.pageY)}j&&j.removeClass(q),g=a(f.target).closest(".view-droppable"),g=g.not(".active,."+k),j=g.length?g:null,j&&(d.each(function(){var b=a(this).data("dnd-row-src"),c=b.data("target");return c&&c===j.data("target")?(j=null,!1):void 0}),j&&j.addClass(q))}).on("mouseup.viewdrag",function(a){1===a.which&&(z.removeClass(n),b._body.removeClass(o+" "+p),h.off(".viewdrag"),i.off(".viewdrag"),d&&d.remove(),j?j.removeClass(q):c||4&u||g())})}if(1===f.which){var s=a(this),t=s.hasClass(k),u=d.modMask(f),v=s.closest(".list"),w=v.children(".list-group").children("."+j),x=w.filter("."+l),y=w.filter("."+m),z=w.filter("."+k);!t||1&u||r(),5!==(5&u)&&(4&u?z=b._selectFromOrigin(x=s,w):(1&u||!t)&&(g(u),1&u||r()))}}).on("dblclick","."+j,function(c){b.trigger("activate",[a(this)])}).on("mousedown",function(c){1===c.which&&(a(c.target).closest("."+j).length||b.trigger("unselectall"))})},_dragRow:function(b,c){var e,f,g=a('<div class="dnd-row"/>').toggleClass("dnd-row-other",!!c),h=b.children(".list-cell:eq(0)").children(".list-cell-content");return g.append(h.clone()),g.data("dnd-row-src",b),this._body.append(g),e=b.offset(),f=b.innerWidth(),g.offset(e).width(f),g.on("movetopointer.viewdrag",function(a){var b={left:a.pageX+1+(c?3:0),top:a.pageY+1+(c?3:0)};d.support.pointerEvents||(b.left+=20),g.offset(b)}).get(0)},_dragInit:function(b,c,d,e){var f=this,g=a(),i=a.Event("movetopointer.viewdrag");if(i.pageX=d,i.pageY=e,c.each(function(c){g=g.add(f._dragRow(a(this),this!==b.get(0)))}),g.width(0).trigger(i),g.length>1){var j=a('<div class="dnd-count"/>').text(g.length);g.not(".dnd-row-other").append(j.hide().fadeIn())}return h.on("mousemove.viewdrag",function(a){i.pageX=a.pageX,i.pageY=a.pageY,g.trigger(i)}),g.hide().fadeIn(200)},loadTarget:function(b,c){function d(c,d){h||e._loadPendingUid!==b||(h=!0,e._loadPendingUid=null,c||(e.viewActive=d.hide().appendTo(e.viewContents),e.trigger("view",[e.viewActive]),e.trigger("select",[a()]),e.loader.hide(),d.fadeIn("fast")))}var e=this,f=e.options.listIdPrefix+b,g=a("#"+f);if(e.viewActive.data("uid")!==b){if(e.trigger("unselectall"),e.viewActive.fadeOut("fast"),g.length)return e.viewActive=g.fadeIn("fast"),e.trigger("view",[e.viewActive]),void e.trigger("select",[a()]);e.loader.show(),e.viewActive=a(),e._loadPendingUid=b;var h=!1;e.trigger("load",[b,c,d])}}})}(jQuery,window);
//# sourceMappingURL=filehub.min.js.map